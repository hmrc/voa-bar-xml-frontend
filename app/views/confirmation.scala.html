@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.FrontendAppConfig
@import models.{Done, Failed, ReportStatus}

@(baCode: String, submissionId: String, appConfig: FrontendAppConfig, reportStatus: Option[ReportStatus] = None)(implicit request: Request[_], messages: Messages)

@main_template(
    title = messages("confirmation.title"),
    appConfig = appConfig,
    bodyClasses = None) {

    @components.service_info(baCode)

    @if(!reportStatus.isDefined || (reportStatus.isDefined && !Seq(Some(Done.value), Some(Failed.value)).contains(reportStatus.get.status))) {
        <input type="hidden" id="refreshUrl" value="@routes.ConfirmationController.onPageRefresh(submissionId)" />
    }

    <span class="voa-logo" aria-hidden="true"><img src="/voa-bar-xml-frontend/assets/images/voalogo.png" alt="Valuation Office Agency"></span>

    <div class="transaction-banner--complete">
        <h1 class="transaction-banner__heading">
            @messages("confirmation.heading")
            @if(reportStatus.isDefined && reportStatus.get.status.isDefined) {
            @messages(s"status.${reportStatus.get.status.get.toLowerCase()}.title")
            } else {
            @messages("status.pending.title")
            }
        </h1>
        @if(!reportStatus.isDefined || (reportStatus.isDefined && !Seq(Some(Failed.value),Some(Done.value)).contains(reportStatus.get.status))) {
            <img src="/voa-bar-xml-frontend/assets/images/spinner-54px.gif" alt="Processing...">
        }
        <h3>@messages("confirmation.submissionId") @submissionId.split("-").head</h3>
        @if(!reportStatus.isDefined || (reportStatus.isDefined && !Seq(Some(Failed.value),Some(Done.value)).contains(reportStatus.get.status))) {
            <p class="print-hide">@messages("confirmation.subheading")</p>
        }
    </div>

    <p class="lede">@messages("confirmation.file.received")</p>

    <p class="print-hide">@messages("confirmation.window.open")</p>

    @if(reportStatus.isDefined && Seq(Some(Failed.value),Some(Done.value)).contains(reportStatus.get.status)) {
        @components.button_link(messageKey = "site.print.button", href = routes.ReportStatusController.onReceiptDownload(submissionId).url, id = "print-button", className = "button print-hidden js-visible")
    }

    <div id="more-options">
    <h2 class="heading-large">
    @messages("confirmation.options.title")
    </h2>
    <ul class="list">
        <li><a id="upload-link" href="@routes.CouncilTaxUploadController.onPageLoad()">@messages("confirmation.options.another")</a></li>
        <li><a id="history-link" href="@routes.ReportStatusController.onPageLoad()">@messages("confirmation.options.history")</a></li>
    </ul>
    </div>

}
