@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.FrontendAppConfig
@import uk.gov.hmrc.play.views.html._
@import controllers.routes._
@import utils.FormHelpers
@import models.Mode
@import models.UpScanRequests._

@(baCode: String, appConfig: FrontendAppConfig, fileUploadForm: Form[_], initiateResponse: Option[InitiateResponse] = None)(implicit request: Request[_], messages: Messages)

@main_template(
    title = messages("councilTaxUpload.title"),
    appConfig = appConfig,
    bodyClasses = None) {

    @components.service_info(baCode)

    @components.heading("councilTaxUpload.heading")

    <ul class="list list-bullet">
        <li>@messages("councilTaxUpload.info.format")</li>
        <li>@messages("councilTaxUpload.info.multi")</li>
        <li>@messages("councilTaxUpload.info.upload")</li>
        <li>@messages("councilTaxUpload.info.size")</li>
        <li>@messages("councilTaxUpload.info.files")</li>
    </ul>

    <form id="councilTaxUploadForm" method="POST" action=@(initiateResponse.get.uploadRequest.href) enctype="multipart/form-data">

        @components.error_summary(fileUploadForm.errors)

        @if(initiateResponse.isDefined) {
            <input type="hidden" name="x-amz-algorithm" value=@(initiateResponse.get.uploadRequest.fields.`x-amz-algorithm`)>
            <input type="hidden" name="x-amz-meta-callback-url" value=@(initiateResponse.get.uploadRequest.fields.`x-amz-meta-callback-url`)>
            <input type="hidden" name="x-amz-date" value=@(initiateResponse.get.uploadRequest.fields.`x-amz-date`)>
            <input type="hidden" name="x-amz-credential" value=@(initiateResponse.get.uploadRequest.fields.`x-amz-credential`)>
            <input type="hidden" name="x-amz-meta-consuming-service" value=@(initiateResponse.get.uploadRequest.fields.`x-amz-meta-consuming-service`)>
            <input type="hidden" name="x-amz-signature" value=@(initiateResponse.get.uploadRequest.fields.`x-amz-signature`)>
            <input type="hidden" name="policy" value=@(initiateResponse.get.uploadRequest.fields.policy)>
            <input type="hidden" name="key" value=@(initiateResponse.get.uploadRequest.fields.key)>
            <input type="hidden" name="acl" value=@(initiateResponse.get.uploadRequest.fields.acl)>

            @helper.inputFile(fileUploadForm("file"), '_label -> messages("councilTaxUpload.xml"), '_help -> "", 'accept -> ".xml", '_type -> "file", 'class -> "upload", 'required -> "required")

            @components.submit_button()

            <p><h5 class="alert">
               @messages("councilTaxUpload.message1")
               <br />
               <br />
               @messages("councilTaxUpload.message2")
            </h5></p>
        }
    </form>
    @helpers.form(action = routes.CouncilTaxUploadController.onSubmit(), 'enctype -> "multipart/form-data", 'id -> "upload-complete-form") {
    }
}
