@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.FrontendAppConfig
@import uk.gov.hmrc.play.views.html._
@import controllers.routes._
@import utils.FormHelpers
@import models.Mode
@import models.UpScanRequests._

@(baCode: String, appConfig: FrontendAppConfig, fileUploadForm: Form[_], initiateResponse: Option[InitiateResponse] = None)(implicit request: Request[_], messages: Messages)

@main_template(
    title = messages("councilTaxUpload.title"),
    appConfig = appConfig,
    bodyClasses = None) {

    @components.service_info(baCode)

    @components.heading("councilTaxUpload.heading")

    <ul class="list list-bullet">
        <li>@messages("councilTaxUpload.info.format")</li>
        <li>@messages("councilTaxUpload.info.multi")</li>
        <li>@messages("councilTaxUpload.info.upload")</li>
        <li>@messages("councilTaxUpload.info.files")</li>
    </ul>

    @components.error_summary(fileUploadForm.errors)

    @if(initiateResponse.isDefined) {
        <input type="hidden" id="councilTaxUploadFormRedirect" value=@(routes.ConfirmationController.onPageLoad(initiateResponse.get.reference)) />
        <input type="hidden" id="councilTaxUploadPrepareUpload" value=@(routes.CouncilTaxUploadController.onPrepareUpload(initiateResponse.get.reference)) />
        <form id="councilTaxUploadForm" method="POST" action=@(initiateResponse.get.uploadRequest.href) enctype="multipart/form-data">

                <input type="hidden" name="reference" value=@(initiateResponse.get.reference)>
                <input type="hidden" name="uploadUrl" value=@(initiateResponse.get.uploadRequest.href)>
                @initiateResponse.get.uploadRequest.fields.map{ case (key, value) =>
                    <input type="hidden" name="@key" value="@value">
                }

                @helper.inputFile(fileUploadForm("file"), '_label -> messages("councilTaxUpload.xml"), '_help -> "", 'accept -> ".xml", '_type -> "file", 'class -> "upload", 'required -> "required")

                @components.submit_button()

                <p><h5 class="alert">
                   @messages("councilTaxUpload.message1")
                   <br />
                   <br />
                   @messages("councilTaxUpload.message2")
                </h5></p>
        </form>
    }
}
